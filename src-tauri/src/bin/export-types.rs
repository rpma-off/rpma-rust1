// We only compile this file for the export-types binary, not the main app

// Note: serde_json::Value is handled via #[ts(type = "any")] attributes in the model definitions
#[cfg(feature = "ts-rs")]
use ts_rs::TS;

// Import your project's models
// NOTE: You'll need to make your models public (e.g., `pub mod models;` in lib.rs)
use rpma_ppf_intervention::models::{
    auth::{DeviceInfo, UserAccount, UserRole, UserSession},
    calendar::{CalendarDateRange, CalendarFilter, CalendarTask, ConflictDetection},
    calendar_event::{
        CreateEventInput, EventParticipant, EventStatus, EventType, ParticipantStatus,
        UpdateEventInput,
    },
    client::{
        Client, ClientListResponse, ClientQuery, ClientStatistics, ClientWithTasks,
        CreateClientRequest, CustomerType, UpdateClientRequest,
    },
    common::{
        FilmType, GpsLocation, LightingCondition, TimestampString, WeatherCondition, WorkLocation,
    },
    intervention::{Intervention, InterventionProgress, InterventionStatus, InterventionType},
    message::{
        Message, MessageListResponse, MessageQuery, MessageTemplate, NotificationPreferences,
        SendMessageRequest, UpdateNotificationPreferencesRequest,
    },
    notification::{
        EmailConfig, EmailProvider, NotificationConfig, NotificationType, SmsConfig, SmsProvider,
        TemplateVariables,
    },
    photo::{Photo, PhotoCategory, PhotoType},
    reports::{
        ClientAnalyticsReport, ClientPerformance, ClientSummary, ComplianceMetrics, CostTrend,
        DailyTaskData, DateRange, ExportFormat, ExportResult, GeographicReport, GeographicStats,
        HeatMapPoint, InterventionBottleneck, InterventionReportResult, MaterialConsumption,
        MaterialCostAnalysis, MaterialEfficiency, MaterialSummary, MaterialUsageReport,
        OperationalIntelligenceReport, OverviewReport, PeakPeriod, PerformanceBenchmarks,
        PerformanceTrend, ProcessEfficiencyMetrics, QualityComplianceReport, QualityIssue,
        QualitySummary, QualityTrend, ReportFilters, ReportMetadata, ReportRequest, ReportResponse,
        ReportStatus, ReportType, ResourceUtilization, RetentionAnalysis, RevenueAnalysis,
        SearchFilters, SearchResponse, SearchResult, SeasonalPattern, SeasonalReport, ServiceArea,
        StatusCount, StepBottleneck, SupplierPerformance, TaskCompletionReport,
        TaskCompletionSummary, TechnicianMetrics, TechnicianPerformance,
        TechnicianPerformanceReport, TechnicianTaskData, WeatherCorrelation,
        WorkflowRecommendation, WorkloadPeriod,
    },
    settings::{
        AppSettings, AppearanceSettings, BackupSettings, DataManagementSettings, DatabaseSettings,
        DiagnosticSettings, GeneralSettings, IntegrationSettings, NotificationSettings,
        PerformanceSettings, SecuritySettings, StorageSettings, SystemConfiguration,
        UserAccessibilitySettings, UserNotificationSettings, UserPerformanceSettings,
        UserPreferences, UserProfileSettings, UserSecuritySettings, UserSettings,
    },
    status::{StatusDistribution, StatusTransitionRequest},
    step::{InterventionStep, StepStatus, StepType},
    sync::{EntityType, OperationType, SyncOperation, SyncQueueMetrics, SyncStatus},
    task::{
        CreateTaskRequest, DeleteTaskRequest, PaginationInfo, SortOrder, Task, TaskListResponse,
        TaskPhoto, TaskPriority, TaskQuery, TaskStatistics, TaskStatus, TaskWithDetails,
        UpdateTaskRequest,
    },
};

// Import service request types
use rpma_ppf_intervention::services::intervention::{
    AdvanceStepRequest, FinalizeInterventionRequest, GpsCoordinates, SaveStepProgressRequest,
    StartInterventionRequest,
};
use rpma_ppf_intervention::services::intervention_types::InterventionMetrics;
use rpma_ppf_intervention::services::prediction::CompletionTimePrediction;

// Import command request types
use rpma_ppf_intervention::commands::{
    notification::{SendNotificationRequest, UpdateNotificationConfigRequest},
    ApiError, CreateUserRequest, UpdateUserRequest, UserAction, UserListResponse,
};

fn main() {
    use std::fs;
    use std::path::PathBuf;

    let output_path = PathBuf::from("../frontend/src/lib/backend.ts");

    // Ensure the directory exists
    if let Some(parent) = output_path.parent() {
        fs::create_dir_all(parent).expect("Failed to create directories");
    }

    // Generate TypeScript definitions using specta
    let mut type_definitions = String::new();

    // Add header comment
    type_definitions.push_str("// Auto-generated TypeScript types from Rust backend\n");
    type_definitions.push_str("// Do not edit manually - generated by export-types.rs\n\n");

    // Export additional types with ts-rs
    type_definitions
        .push_str(&DeviceInfo::export_to_string().expect("Failed to export DeviceInfo type"));
    type_definitions.push_str("\n\n");

    // Error types (ts-rs exports)
    type_definitions.push_str("// Error types\n");
    type_definitions
        .push_str(&ApiError::export_to_string().expect("Failed to export ApiError type"));
    type_definitions.push_str("\n\n");

    // Auth types (ts-rs exports)
    type_definitions.push_str("// Auth types\n");
    type_definitions
        .push_str(&UserAccount::export_to_string().expect("Failed to export UserAccount type"));
    type_definitions.push_str("\n");
    type_definitions
        .push_str(&UserRole::export_to_string().expect("Failed to export UserRole type"));
    type_definitions.push_str("\n");
    type_definitions
        .push_str(&UserSession::export_to_string().expect("Failed to export UserSession type"));
    type_definitions.push_str("\n\n");

    // Event types
    type_definitions.push_str("// Event types\n");
    type_definitions
        .push_str(&EventType::export_to_string().expect("Failed to export EventType type"));
    type_definitions.push_str("\n");
    type_definitions.push_str(
        &EventParticipant::export_to_string().expect("Failed to export EventParticipant type"),
    );
    type_definitions.push_str("\n");
    type_definitions.push_str(
        &ParticipantStatus::export_to_string().expect("Failed to export ParticipantStatus type"),
    );
    type_definitions.push_str("\n");
    type_definitions
        .push_str(&EventStatus::export_to_string().expect("Failed to export EventStatus type"));
    type_definitions.push_str("\n");
    type_definitions.push_str(
        &CreateEventInput::export_to_string().expect("Failed to export CreateEventInput type"),
    );
    type_definitions.push_str("\n");
    type_definitions.push_str(
        &UpdateEventInput::export_to_string().expect("Failed to export UpdateEventInput type"),
    );
    type_definitions.push_str("\n\n");

    // Calendar additional types
    type_definitions.push_str("// Calendar additional types\n");
    type_definitions
        .push_str(&CalendarTask::export_to_string().expect("Failed to export CalendarTask type"));
    type_definitions.push_str("\n");
    type_definitions.push_str(
        &CalendarFilter::export_to_string().expect("Failed to export CalendarFilter type"),
    );
    type_definitions.push_str("\n");
    type_definitions.push_str(
        &ConflictDetection::export_to_string().expect("Failed to export ConflictDetection type"),
    );
    type_definitions.push_str("\n");
    type_definitions.push_str(
        &CalendarDateRange::export_to_string().expect("Failed to export CalendarDateRange type"),
    );
    type_definitions.push_str("\n\n");

    // Client types
    type_definitions.push_str("// Client types\n");
    type_definitions.push_str(&Client::export_to_string().expect("Failed to export Client type"));
    type_definitions.push_str("\n");
    type_definitions.push_str(
        &ClientWithTasks::export_to_string().expect("Failed to export ClientWithTasks type"),
    );
    type_definitions.push_str("\n");
    type_definitions
        .push_str(&ClientQuery::export_to_string().expect("Failed to export ClientQuery type"));
    type_definitions.push_str("\n");
    type_definitions
        .push_str(&CustomerType::export_to_string().expect("Failed to export CustomerType type"));
    type_definitions.push_str("\n");
    type_definitions.push_str(
        &CreateClientRequest::export_to_string()
            .expect("Failed to export CreateClientRequest type"),
    );
    type_definitions.push_str("\n");
    type_definitions.push_str(
        &UpdateClientRequest::export_to_string()
            .expect("Failed to export UpdateClientRequest type"),
    );
    type_definitions.push_str("\n");
    type_definitions.push_str(
        &ClientListResponse::export_to_string().expect("Failed to export ClientListResponse type"),
    );
    type_definitions.push_str("\n");
    type_definitions.push_str(
        &ClientStatistics::export_to_string().expect("Failed to export ClientStatistics type"),
    );
    type_definitions.push_str("\n\n");

    // Task types
    type_definitions.push_str("// Task types\n");
    type_definitions.push_str(&Task::export_to_string().expect("Failed to export Task type"));
    type_definitions.push_str("\n");
    type_definitions
        .push_str(&TaskStatus::export_to_string().expect("Failed to export TaskStatus type"));
    type_definitions.push_str("\n");
    type_definitions
        .push_str(&TaskPriority::export_to_string().expect("Failed to export TaskPriority type"));
    type_definitions.push_str("\n");
    type_definitions.push_str(
        &CreateTaskRequest::export_to_string().expect("Failed to export CreateTaskRequest type"),
    );
    type_definitions.push_str("\n");
    type_definitions.push_str(
        &UpdateTaskRequest::export_to_string().expect("Failed to export UpdateTaskRequest type"),
    );
    type_definitions.push_str("\n");
    type_definitions
        .push_str(&TaskQuery::export_to_string().expect("Failed to export TaskQuery type"));
    type_definitions.push_str("\n");
    type_definitions
        .push_str(&TaskPhoto::export_to_string().expect("Failed to export TaskPhoto type"));
    type_definitions.push_str("\n");
    type_definitions
        .push_str(&SortOrder::export_to_string().expect("Failed to export SortOrder type"));
    type_definitions.push_str("\n");
    type_definitions.push_str(
        &TaskWithDetails::export_to_string().expect("Failed to export TaskWithDetails type"),
    );
    type_definitions.push_str("\n");
    type_definitions.push_str(
        &DeleteTaskRequest::export_to_string().expect("Failed to export DeleteTaskRequest type"),
    );
    type_definitions.push_str("\n");
    type_definitions.push_str(
        &TaskListResponse::export_to_string().expect("Failed to export TaskListResponse type"),
    );
    type_definitions.push_str("\n");
    type_definitions.push_str(
        &PaginationInfo::export_to_string().expect("Failed to export PaginationInfo type"),
    );
    type_definitions.push_str("\n");
    type_definitions.push_str(
        &TaskStatistics::export_to_string().expect("Failed to export TaskStatistics type"),
    );
    type_definitions.push_str("\n\n");

    // Photo types
    type_definitions.push_str("// Photo types\n");
    type_definitions.push_str(&Photo::export_to_string().expect("Failed to export Photo type"));
    type_definitions.push_str("\n");
    type_definitions
        .push_str(&PhotoType::export_to_string().expect("Failed to export PhotoType type"));
    type_definitions.push_str("\n");
    type_definitions
        .push_str(&PhotoCategory::export_to_string().expect("Failed to export PhotoCategory type"));
    type_definitions.push_str("\n\n");

    // Intervention types
    type_definitions.push_str("// Intervention types\n");
    type_definitions
        .push_str(&Intervention::export_to_string().expect("Failed to export Intervention type"));
    type_definitions.push_str("\n");
    type_definitions.push_str(
        &InterventionStatus::export_to_string().expect("Failed to export InterventionStatus type"),
    );
    type_definitions.push_str("\n");
    type_definitions.push_str(
        &InterventionType::export_to_string().expect("Failed to export InterventionType type"),
    );
    type_definitions.push_str("\n");
    type_definitions
        .push_str(&GpsLocation::export_to_string().expect("Failed to export GpsLocation type"));
    type_definitions.push_str("\n");
    type_definitions
        .push_str(&FilmType::export_to_string().expect("Failed to export FilmType type"));
    type_definitions.push_str("\n");
    type_definitions.push_str(
        &WeatherCondition::export_to_string().expect("Failed to export WeatherCondition type"),
    );
    type_definitions.push_str("\n");
    type_definitions.push_str(
        &LightingCondition::export_to_string().expect("Failed to export LightingCondition type"),
    );
    type_definitions.push_str("\n");
    type_definitions
        .push_str(&WorkLocation::export_to_string().expect("Failed to export WorkLocation type"));
    type_definitions.push_str("\n");
    type_definitions.push_str(
        &TimestampString::export_to_string().expect("Failed to export TimestampString type"),
    );
    type_definitions.push_str("\n");
    type_definitions.push_str(
        &GpsCoordinates::export_to_string().expect("Failed to export GpsCoordinates type"),
    );
    type_definitions.push_str("\n");
    type_definitions.push_str(
        &InterventionStep::export_to_string().expect("Failed to export InterventionStep type"),
    );
    type_definitions.push_str("\n");
    type_definitions
        .push_str(&StepType::export_to_string().expect("Failed to export StepType type"));
    type_definitions.push_str("\n");
    type_definitions.push_str(
        &StartInterventionRequest::export_to_string()
            .expect("Failed to export StartInterventionRequest type"),
    );
    type_definitions.push_str("\n");
    type_definitions.push_str(
        &AdvanceStepRequest::export_to_string().expect("Failed to export AdvanceStepRequest type"),
    );
    type_definitions.push_str("\n");
    type_definitions.push_str(
        &SaveStepProgressRequest::export_to_string()
            .expect("Failed to export SaveStepProgressRequest type"),
    );
    type_definitions.push_str("\n");
    type_definitions.push_str(
        &FinalizeInterventionRequest::export_to_string()
            .expect("Failed to export FinalizeInterventionRequest type"),
    );
    type_definitions.push_str("\n");
    type_definitions.push_str(
        &InterventionProgress::export_to_string()
            .expect("Failed to export InterventionProgress type"),
    );
    type_definitions.push_str("\n");
    type_definitions.push_str(
        &InterventionMetrics::export_to_string()
            .expect("Failed to export InterventionMetrics type"),
    );
    type_definitions.push_str("\n");
    type_definitions
        .push_str(&StepStatus::export_to_string().expect("Failed to export StepStatus type"));
    type_definitions.push_str("\n");
    type_definitions.push_str(
        &NotificationType::export_to_string().expect("Failed to export NotificationType type"),
    );
    type_definitions.push_str("\n");
    type_definitions.push_str(
        &TemplateVariables::export_to_string().expect("Failed to export TemplateVariables type"),
    );
    type_definitions.push_str("\n");
    type_definitions
        .push_str(&EmailProvider::export_to_string().expect("Failed to export EmailProvider type"));
    type_definitions.push_str("\n");
    type_definitions
        .push_str(&EmailConfig::export_to_string().expect("Failed to export EmailConfig type"));
    type_definitions.push_str("\n");
    type_definitions
        .push_str(&SmsProvider::export_to_string().expect("Failed to export SmsProvider type"));
    type_definitions.push_str("\n");
    type_definitions
        .push_str(&SmsConfig::export_to_string().expect("Failed to export SmsConfig type"));
    type_definitions.push_str("\n");
    type_definitions.push_str(
        &NotificationConfig::export_to_string().expect("Failed to export NotificationConfig type"),
    );
    type_definitions.push_str("\n");
    type_definitions.push_str(
        &UpdateNotificationConfigRequest::export_to_string()
            .expect("Failed to export UpdateNotificationConfigRequest type"),
    );
    type_definitions.push_str("\n");
    type_definitions.push_str(
        &SendNotificationRequest::export_to_string()
            .expect("Failed to export SendNotificationRequest type"),
    );
    type_definitions.push_str("\n");
    type_definitions.push_str(&Message::export_to_string().expect("Failed to export Message type"));
    type_definitions.push_str("\n");
    type_definitions
        .push_str(&MessageQuery::export_to_string().expect("Failed to export MessageQuery type"));
    type_definitions.push_str("\n");
    type_definitions.push_str(
        &MessageListResponse::export_to_string()
            .expect("Failed to export MessageListResponse type"),
    );
    type_definitions.push_str("\n");
    type_definitions.push_str(
        &MessageTemplate::export_to_string().expect("Failed to export MessageTemplate type"),
    );
    type_definitions.push_str("\n");
    type_definitions.push_str(
        &SendMessageRequest::export_to_string().expect("Failed to export SendMessageRequest type"),
    );
    type_definitions.push_str("\n");
    type_definitions.push_str(
        &NotificationPreferences::export_to_string()
            .expect("Failed to export NotificationPreferences type"),
    );
    type_definitions.push_str("\n");
    type_definitions.push_str(
        &UpdateNotificationPreferencesRequest::export_to_string()
            .expect("Failed to export UpdateNotificationPreferencesRequest type"),
    );
    type_definitions.push_str("\n");
    type_definitions.push_str(
        &CreateUserRequest::export_to_string().expect("Failed to export CreateUserRequest type"),
    );
    type_definitions.push_str("\n");
    type_definitions.push_str(
        &UpdateUserRequest::export_to_string().expect("Failed to export UpdateUserRequest type"),
    );
    type_definitions.push_str("\n");
    type_definitions
        .push_str(&UserAction::export_to_string().expect("Failed to export UserAction type"));
    type_definitions.push_str("\n");
    type_definitions.push_str(
        &UserListResponse::export_to_string().expect("Failed to export UserListResponse type"),
    );
    type_definitions.push_str("\n\n");

    // Status types
    type_definitions.push_str("// Status types\n");
    type_definitions.push_str(
        &StatusDistribution::export_to_string().expect("Failed to export StatusDistribution type"),
    );
    type_definitions.push_str("\n");
    type_definitions.push_str(
        &StatusTransitionRequest::export_to_string()
            .expect("Failed to export StatusTransitionRequest type"),
    );
    type_definitions.push_str("\n\n");

    // Sync types
    type_definitions.push_str("// Sync types\n");
    type_definitions
        .push_str(&EntityType::export_to_string().expect("Failed to export EntityType type"));
    type_definitions.push_str("\n");
    type_definitions
        .push_str(&SyncOperation::export_to_string().expect("Failed to export SyncOperation type"));
    type_definitions.push_str("\n");
    type_definitions
        .push_str(&SyncStatus::export_to_string().expect("Failed to export SyncStatus type"));
    type_definitions.push_str("\n");
    type_definitions
        .push_str(&OperationType::export_to_string().expect("Failed to export OperationType type"));
    type_definitions.push_str("\n");
    type_definitions.push_str(
        &SyncQueueMetrics::export_to_string().expect("Failed to export SyncQueueMetrics type"),
    );
    type_definitions.push_str("\n\n");

    // Reports types
    type_definitions.push_str("// Reports types\n");
    type_definitions
        .push_str(&DateRange::export_to_string().expect("Failed to export DateRange type"));
    type_definitions.push_str("\n");
    type_definitions
        .push_str(&ReportFilters::export_to_string().expect("Failed to export ReportFilters type"));
    type_definitions.push_str("\n");
    type_definitions
        .push_str(&ReportType::export_to_string().expect("Failed to export ReportType type"));
    type_definitions.push_str("\n");
    type_definitions
        .push_str(&ExportFormat::export_to_string().expect("Failed to export ExportFormat type"));
    type_definitions.push_str("\n");
    type_definitions.push_str(
        &ReportMetadata::export_to_string().expect("Failed to export ReportMetadata type"),
    );
    type_definitions.push_str("\n");
    type_definitions
        .push_str(&SearchResult::export_to_string().expect("Failed to export SearchResult type"));
    type_definitions.push_str("\n");
    type_definitions
        .push_str(&SearchFilters::export_to_string().expect("Failed to export SearchFilters type"));
    type_definitions.push_str("\n");
    type_definitions.push_str(
        &SearchResponse::export_to_string().expect("Failed to export SearchResponse type"),
    );
    type_definitions.push_str("\n");
    type_definitions.push_str(
        &OverviewReport::export_to_string().expect("Failed to export OverviewReport type"),
    );
    type_definitions.push_str("\n");
    type_definitions.push_str(
        &GeographicReport::export_to_string().expect("Failed to export GeographicReport type"),
    );
    type_definitions.push_str("\n");
    type_definitions.push_str(
        &SeasonalReport::export_to_string().expect("Failed to export SeasonalReport type"),
    );
    type_definitions.push_str("\n");
    type_definitions
        .push_str(&HeatMapPoint::export_to_string().expect("Failed to export HeatMapPoint type"));
    type_definitions.push_str("\n");
    type_definitions.push_str(
        &GeographicStats::export_to_string().expect("Failed to export GeographicStats type"),
    );
    type_definitions.push_str("\n");
    type_definitions
        .push_str(&ServiceArea::export_to_string().expect("Failed to export ServiceArea type"));
    type_definitions.push_str("\n");
    type_definitions
        .push_str(&PeakPeriod::export_to_string().expect("Failed to export PeakPeriod type"));
    type_definitions.push_str("\n");
    type_definitions.push_str(
        &SeasonalPattern::export_to_string().expect("Failed to export SeasonalPattern type"),
    );
    type_definitions.push_str("\n");
    type_definitions.push_str(
        &WeatherCorrelation::export_to_string().expect("Failed to export WeatherCorrelation type"),
    );
    type_definitions.push_str("\n");
    type_definitions.push_str(
        &TaskCompletionReport::export_to_string()
            .expect("Failed to export TaskCompletionReport type"),
    );
    type_definitions.push_str("\n");
    type_definitions.push_str(
        &TaskCompletionSummary::export_to_string()
            .expect("Failed to export TaskCompletionSummary type"),
    );
    type_definitions.push_str("\n");
    type_definitions
        .push_str(&DailyTaskData::export_to_string().expect("Failed to export DailyTaskData type"));
    type_definitions.push_str("\n");
    type_definitions
        .push_str(&StatusCount::export_to_string().expect("Failed to export StatusCount type"));
    type_definitions.push_str("\n");
    type_definitions.push_str(
        &TechnicianTaskData::export_to_string().expect("Failed to export TechnicianTaskData type"),
    );
    type_definitions.push_str("\n");
    type_definitions.push_str(
        &TechnicianPerformanceReport::export_to_string()
            .expect("Failed to export TechnicianPerformanceReport type"),
    );
    type_definitions.push_str("\n");
    type_definitions.push_str(
        &TechnicianPerformance::export_to_string()
            .expect("Failed to export TechnicianPerformance type"),
    );
    type_definitions.push_str("\n");
    type_definitions.push_str(
        &TechnicianMetrics::export_to_string().expect("Failed to export TechnicianMetrics type"),
    );
    type_definitions.push_str("\n");
    type_definitions.push_str(
        &PerformanceBenchmarks::export_to_string()
            .expect("Failed to export PerformanceBenchmarks type"),
    );
    type_definitions.push_str("\n");
    type_definitions.push_str(
        &PerformanceTrend::export_to_string().expect("Failed to export PerformanceTrend type"),
    );
    type_definitions.push_str("\n");
    type_definitions.push_str(
        &ClientAnalyticsReport::export_to_string()
            .expect("Failed to export ClientAnalyticsReport type"),
    );
    type_definitions.push_str("\n");
    type_definitions
        .push_str(&ClientSummary::export_to_string().expect("Failed to export ClientSummary type"));
    type_definitions.push_str("\n");
    type_definitions.push_str(
        &RetentionAnalysis::export_to_string().expect("Failed to export RetentionAnalysis type"),
    );
    type_definitions.push_str("\n");
    type_definitions.push_str(
        &RevenueAnalysis::export_to_string().expect("Failed to export RevenueAnalysis type"),
    );
    type_definitions.push_str("\n");
    type_definitions.push_str(
        &ClientPerformance::export_to_string().expect("Failed to export ClientPerformance type"),
    );
    type_definitions.push_str("\n");
    type_definitions.push_str(
        &QualityComplianceReport::export_to_string()
            .expect("Failed to export QualityComplianceReport type"),
    );
    type_definitions.push_str("\n");
    type_definitions.push_str(
        &QualitySummary::export_to_string().expect("Failed to export QualitySummary type"),
    );
    type_definitions.push_str("\n");
    type_definitions
        .push_str(&QualityTrend::export_to_string().expect("Failed to export QualityTrend type"));
    type_definitions.push_str("\n");
    type_definitions
        .push_str(&QualityIssue::export_to_string().expect("Failed to export QualityIssue type"));
    type_definitions.push_str("\n");
    type_definitions.push_str(
        &ComplianceMetrics::export_to_string().expect("Failed to export ComplianceMetrics type"),
    );
    type_definitions.push_str("\n");
    type_definitions.push_str(
        &MaterialUsageReport::export_to_string()
            .expect("Failed to export MaterialUsageReport type"),
    );
    type_definitions.push_str("\n");
    type_definitions.push_str(
        &MaterialSummary::export_to_string().expect("Failed to export MaterialSummary type"),
    );
    type_definitions.push_str("\n");
    type_definitions.push_str(
        &MaterialConsumption::export_to_string()
            .expect("Failed to export MaterialConsumption type"),
    );
    type_definitions.push_str("\n");
    type_definitions.push_str(
        &MaterialCostAnalysis::export_to_string()
            .expect("Failed to export MaterialCostAnalysis type"),
    );
    type_definitions.push_str("\n");
    type_definitions
        .push_str(&CostTrend::export_to_string().expect("Failed to export CostTrend type"));
    type_definitions.push_str("\n");
    type_definitions.push_str(
        &SupplierPerformance::export_to_string()
            .expect("Failed to export SupplierPerformance type"),
    );
    type_definitions.push_str("\n");
    type_definitions.push_str(
        &MaterialEfficiency::export_to_string().expect("Failed to export MaterialEfficiency type"),
    );
    type_definitions.push_str("\n");
    type_definitions
        .push_str(&ExportResult::export_to_string().expect("Failed to export ExportResult type"));
    type_definitions.push_str("\n");
    type_definitions
        .push_str(&ReportRequest::export_to_string().expect("Failed to export ReportRequest type"));
    type_definitions.push_str("\n");
    type_definitions.push_str(
        &ReportResponse::export_to_string().expect("Failed to export ReportResponse type"),
    );
    type_definitions.push_str("\n");
    type_definitions
        .push_str(&ReportStatus::export_to_string().expect("Failed to export ReportStatus type"));
    type_definitions.push_str("\n");
    type_definitions.push_str(
        &OperationalIntelligenceReport::export_to_string()
            .expect("Failed to export OperationalIntelligenceReport type"),
    );
    type_definitions.push_str("\n");
    type_definitions.push_str(
        &StepBottleneck::export_to_string().expect("Failed to export StepBottleneck type"),
    );
    type_definitions.push_str("\n");
    type_definitions.push_str(
        &InterventionBottleneck::export_to_string()
            .expect("Failed to export InterventionBottleneck type"),
    );
    type_definitions.push_str("\n");
    type_definitions.push_str(
        &InterventionReportResult::export_to_string()
            .expect("Failed to export InterventionReportResult type"),
    );
    type_definitions.push_str("\n");
    type_definitions.push_str(
        &ResourceUtilization::export_to_string()
            .expect("Failed to export ResourceUtilization type"),
    );
    type_definitions.push_str("\n");
    type_definitions.push_str(
        &ProcessEfficiencyMetrics::export_to_string()
            .expect("Failed to export ProcessEfficiencyMetrics type"),
    );
    type_definitions.push_str("\n");
    type_definitions.push_str(
        &WorkflowRecommendation::export_to_string()
            .expect("Failed to export WorkflowRecommendation type"),
    );
    type_definitions.push_str("\n");
    type_definitions.push_str(
        &CompletionTimePrediction::export_to_string()
            .expect("Failed to export CompletionTimePrediction type"),
    );
    type_definitions.push_str("\n");
    type_definitions.push_str(
        &WorkloadPeriod::export_to_string().expect("Failed to export WorkloadPeriod type"),
    );
    type_definitions.push_str("\n\n");

    // Settings types
    type_definitions.push_str("// Settings types\n");
    type_definitions
        .push_str(&AppSettings::export_to_string().expect("Failed to export AppSettings type"));
    type_definitions.push_str("\n");
    type_definitions.push_str(
        &GeneralSettings::export_to_string().expect("Failed to export GeneralSettings type"),
    );
    type_definitions.push_str("\n");
    type_definitions.push_str(
        &SecuritySettings::export_to_string().expect("Failed to export SecuritySettings type"),
    );
    type_definitions.push_str("\n");
    type_definitions.push_str(
        &NotificationSettings::export_to_string()
            .expect("Failed to export NotificationSettings type"),
    );
    type_definitions.push_str("\n");
    type_definitions.push_str(
        &AppearanceSettings::export_to_string().expect("Failed to export AppearanceSettings type"),
    );
    type_definitions.push_str("\n");
    type_definitions.push_str(
        &DataManagementSettings::export_to_string()
            .expect("Failed to export DataManagementSettings type"),
    );
    type_definitions.push_str("\n");
    type_definitions.push_str(
        &DatabaseSettings::export_to_string().expect("Failed to export DatabaseSettings type"),
    );
    type_definitions.push_str("\n");
    type_definitions.push_str(
        &IntegrationSettings::export_to_string()
            .expect("Failed to export IntegrationSettings type"),
    );
    type_definitions.push_str("\n");
    type_definitions.push_str(
        &PerformanceSettings::export_to_string()
            .expect("Failed to export PerformanceSettings type"),
    );
    type_definitions.push_str("\n");
    type_definitions.push_str(
        &BackupSettings::export_to_string().expect("Failed to export BackupSettings type"),
    );
    type_definitions.push_str("\n");
    type_definitions.push_str(
        &DiagnosticSettings::export_to_string().expect("Failed to export DiagnosticSettings type"),
    );
    type_definitions.push_str("\n");
    type_definitions.push_str(
        &SystemConfiguration::export_to_string()
            .expect("Failed to export SystemConfiguration type"),
    );
    type_definitions.push_str("\n");
    type_definitions.push_str(
        &StorageSettings::export_to_string().expect("Failed to export StorageSettings type"),
    );
    type_definitions.push_str("\n");
    type_definitions.push_str(
        &UserProfileSettings::export_to_string()
            .expect("Failed to export UserProfileSettings type"),
    );
    type_definitions.push_str("\n");
    type_definitions.push_str(
        &UserPreferences::export_to_string().expect("Failed to export UserPreferences type"),
    );
    type_definitions.push_str("\n");
    type_definitions.push_str(
        &UserSecuritySettings::export_to_string()
            .expect("Failed to export UserSecuritySettings type"),
    );
    type_definitions.push_str("\n");
    type_definitions.push_str(
        &UserPerformanceSettings::export_to_string()
            .expect("Failed to export UserPerformanceSettings type"),
    );
    type_definitions.push_str("\n");
    type_definitions.push_str(
        &UserAccessibilitySettings::export_to_string()
            .expect("Failed to export UserAccessibilitySettings type"),
    );
    type_definitions.push_str("\n");
    type_definitions.push_str(
        &UserNotificationSettings::export_to_string()
            .expect("Failed to export UserNotificationSettings type"),
    );
    type_definitions.push_str("\n");
    type_definitions
        .push_str(&UserSettings::export_to_string().expect("Failed to export UserSettings type"));
    type_definitions.push_str("\n\n");

    // List of all types we're exporting to filter out invalid imports
    let exported_types = vec![
        "ApiError",
        "DeviceInfo",
        "UserAccount",
        "UserRole",
        "UserSession",
        "CalendarTask",
        "CalendarFilter",
        "ConflictDetection",
        "CalendarDateRange",
        "CreateEventInput",
        "UpdateEventInput",
        "ParticipantStatus",
        "Client",
        "ClientWithTasks",
        "ClientQuery",
        "CustomerType",
        "CreateClientRequest",
        "UpdateClientRequest",
        "ClientListResponse",
        "ClientStatistics",
        "Task",
        "TaskStatus",
        "TaskPriority",
        "CreateTaskRequest",
        "UpdateTaskRequest",
        "TaskQuery",
        "TaskPhoto",
        "SortOrder",
        "TaskWithDetails",
        "DeleteTaskRequest",
        "TaskListResponse",
        "PaginationInfo",
        "TaskStatistics",
        "Photo",
        "PhotoType",
        "PhotoCategory",
        "Intervention",
        "InterventionStatus",
        "InterventionType",
        "InterventionStep",
        "StepType",
        "InterventionProgress",
        "InterventionMetrics",
        "StepStatus",
        "StartInterventionRequest",
        "AdvanceStepRequest",
        "SaveStepProgressRequest",
        "FinalizeInterventionRequest",
        "NotificationType",
        "TemplateVariables",
        "EmailProvider",
        "EmailConfig",
        "SmsProvider",
        "SmsConfig",
        "NotificationConfig",
        "UpdateNotificationConfigRequest",
        "SendNotificationRequest",
        "Message",
        "MessageQuery",
        "MessageListResponse",
        "MessageTemplate",
        "SendMessageRequest",
        "NotificationPreferences",
        "UpdateNotificationPreferencesRequest",
        "CreateUserRequest",
        "UpdateUserRequest",
        "UserAction",
        "UserListResponse",
        "StatusDistribution",
        "StatusTransitionRequest",
        "UserSettings",
        "EntityType",
        "SyncOperation",
        "SyncStatus",
        "OperationType",
        "SyncQueueMetrics",
        "AppSettings",
        "GeneralSettings",
        "SecuritySettings",
        "NotificationSettings",
        "AppearanceSettings",
        "DataManagementSettings",
        "DatabaseSettings",
        "IntegrationSettings",
        "PerformanceSettings",
        "BackupSettings",
        "DiagnosticSettings",
        "SystemConfiguration",
        "UserProfileSettings",
        "UserPreferences",
        "UserSecuritySettings",
        "UserPerformanceSettings",
        "UserAccessibilitySettings",
        "UserNotificationSettings",
        "UserSettings",
        "GpsLocation",
        "FilmType",
        "LightingCondition",
        "WeatherCondition",
        "WorkLocation",
        "TimestampString",
        "GpsCoordinates",
        // Reports types
        "DateRange",
        "ReportFilters",
        "ReportType",
        "ExportFormat",
        "ReportMetadata",
        "SearchResult",
        "SearchFilters",
        "SearchResponse",
        "OverviewReport",
        "GeographicReport",
        "SeasonalReport",
        "HeatMapPoint",
        "GeographicStats",
        "ServiceArea",
        "PeakPeriod",
        "SeasonalPattern",
        "WeatherCorrelation",
        "TaskCompletionReport",
        "TaskCompletionSummary",
        "DailyTaskData",
        "StatusCount",
        "TechnicianTaskData",
        "TechnicianPerformanceReport",
        "TechnicianPerformance",
        "TechnicianMetrics",
        "PerformanceBenchmarks",
        "PerformanceTrend",
        "ClientAnalyticsReport",
        "ClientSummary",
        "RetentionAnalysis",
        "RevenueAnalysis",
        "ClientPerformance",
        "QualityComplianceReport",
        "QualitySummary",
        "QualityTrend",
        "QualityIssue",
        "ComplianceMetrics",
        "MaterialUsageReport",
        "MaterialSummary",
        "MaterialConsumption",
        "MaterialCostAnalysis",
        "CostTrend",
        "SupplierPerformance",
        "MaterialEfficiency",
        "ExportResult",
        "ReportRequest",
        "ReportResponse",
        "ReportStatus",
        "OperationalIntelligenceReport",
        "StepBottleneck",
        "InterventionBottleneck",
        "InterventionReportResult",
        "ResourceUtilization",
        "ProcessEfficiencyMetrics",
        "WorkflowRecommendation",
        "CompletionTimePrediction",
        "WorkloadPeriod",
    ];

    // Post-process: remove import statements for types that are defined in this file
    let mut processed_definitions = String::new();

    for line in type_definitions.lines() {
        let mut should_skip = false;

        // Check if this line is an import for a type we're exporting
        if line.starts_with("import type") {
            for exported_type in &exported_types {
                if line.contains(&format!("{{ {} }}", exported_type))
                    && line.contains(&format!("\"./{}\"", exported_type))
                {
                    should_skip = true;
                    break;
                }
            }
        }

        if !should_skip {
            processed_definitions.push_str(line);
            processed_definitions.push('\n');
        }
    }

    // Output to stdout for npm script to handle file writing
    println!("{}", processed_definitions);

    eprintln!(
        "âœ… Successfully exported Rust types to TypeScript at {}",
        output_path.display()
    );
}
