{
  "extends": ["next/core-web-vitals", "next/typescript"],
  "plugins": ["import"],
  "rules": {
    "@typescript-eslint/no-unused-vars": ["warn", {
      "argsIgnorePattern": "^_",
      "varsIgnorePattern": "^_",
      "destructuredArrayIgnorePattern": "^_",
      "caughtErrorsIgnorePattern": "^_"
    }],
    "@typescript-eslint/no-explicit-any": "warn",
    "@typescript-eslint/no-require-imports": "off",
    "import/no-cycle": ["error", { "ignoreExternal": true, "maxDepth": 2 }]
  },
  "overrides": [
    {
      "files": ["src/app/**/*.{ts,tsx}"],
      "excludedFiles": ["src/app/api/**"],
      "rules": {
        "no-restricted-imports": [
          "error",
          {
            "paths": [
              {
                "name": "@/shared/utils",
                "importNames": ["safeInvoke", "IPC_COMMANDS"],
                "message": "Do not use raw IPC (safeInvoke/IPC_COMMANDS) in app pages. Use a domain hook or shared hook instead."
              }
            ],
            "patterns": [
              {
                "group": ["@/components/**", "@/lib/**", "@/hooks/**", "@/contexts/**", "@/types/**"],
                "message": "App layer may only import from domain public APIs (e.g. `@/domains/<domain>`) or `@/shared/**`."
              },
              {
                "group": ["@/domains/*/components/**", "@/domains/*/hooks/**", "@/domains/*/services/**", "@/domains/*/ipc/**", "@/domains/*/server/**"],
                "message": "App layer must import domain public APIs only (use `@/domains/<domain>` or `@/domains/<domain>/api`)."
              }
            ]
          }
        ]
      }
    },
    {
      "files": ["src/app/api/**/*.{ts,tsx}"],
      "rules": {
        "no-restricted-imports": [
          "error",
          {
            "patterns": [
              {
                "group": ["@/lib/services/**", "@/lib/ipc/domains/**"],
                "message": "Do not import legacy service or raw IPC modules directly in API routes. Use `@/domains/<domain>/server`."
              },
              {
                "group": ["@/domains/*/api", "@/domains/*/api/**", "@/domains/*/components/**", "@/domains/*/hooks/**", "@/domains/*/services/**", "@/domains/*/ipc/**"],
                "message": "API routes must import domain modules through `@/domains/<domain>/server` only."
              }
            ]
          }
        ]
      }
    },
    {
      "files": ["src/hooks/**/*.{ts,tsx}", "src/components/**/*.{ts,tsx}", "src/shared/**/*.{ts,tsx}"],
      "rules": {
        "no-restricted-imports": [
          "error",
          {
            "patterns": [
              {
                "group": ["@/lib/services/**", "@/lib/ipc/domains/**"],
                "message": "Use domain APIs or domain server facades instead of legacy service/IPC module paths."
              },
              {
                "group": ["@/domains/*/components/**", "@/domains/*/hooks/**", "@/domains/*/services/**", "@/domains/*/ipc/**"],
                "message": "Non-domain layers must not import deep domain internals. Use `@/domains/<domain>`."
              }
            ]
          }
        ]
      }
    },
    {
      "files": ["src/domains/auth/**/*.{ts,tsx}"],
      "rules": {
        "no-restricted-imports": [
          "error",
          {
            "patterns": [
              {
                "group": [
                  "@/domains/tasks/components/**", "@/domains/tasks/hooks/**", "@/domains/tasks/services/**", "@/domains/tasks/ipc/**",
                  "@/domains/inventory/components/**", "@/domains/inventory/hooks/**", "@/domains/inventory/services/**", "@/domains/inventory/ipc/**",
                  "@/domains/interventions/components/**", "@/domains/interventions/hooks/**", "@/domains/interventions/services/**", "@/domains/interventions/ipc/**"
                ],
                "message": "Domains may only import other domains via their public API (e.g. `@/domains/<domain>`)."
              }
            ]
          }
        ]
      }
    },
    {
      "files": ["src/domains/tasks/**/*.{ts,tsx}"],
      "rules": {
        "no-restricted-imports": [
          "error",
          {
            "patterns": [
              {
                "group": [
                  "@/domains/auth/components/**", "@/domains/auth/hooks/**", "@/domains/auth/services/**", "@/domains/auth/ipc/**",
                  "@/domains/inventory/components/**", "@/domains/inventory/hooks/**", "@/domains/inventory/services/**", "@/domains/inventory/ipc/**",
                  "@/domains/interventions/components/**", "@/domains/interventions/hooks/**", "@/domains/interventions/services/**", "@/domains/interventions/ipc/**"
                ],
                "message": "Domains may only import other domains via their public API (e.g. `@/domains/<domain>`)."
              }
            ]
          }
        ]
      }
    },
    {
      "files": ["src/domains/inventory/**/*.{ts,tsx}"],
      "rules": {
        "no-restricted-imports": [
          "error",
          {
            "patterns": [
              {
                "group": [
                  "@/domains/auth/components/**", "@/domains/auth/hooks/**", "@/domains/auth/services/**", "@/domains/auth/ipc/**",
                  "@/domains/tasks/components/**", "@/domains/tasks/hooks/**", "@/domains/tasks/services/**", "@/domains/tasks/ipc/**",
                  "@/domains/interventions/components/**", "@/domains/interventions/hooks/**", "@/domains/interventions/services/**", "@/domains/interventions/ipc/**"
                ],
                "message": "Domains may only import other domains via their public API (e.g. `@/domains/<domain>`)."
              }
            ]
          }
        ]
      }
    },
    {
      "files": ["src/domains/interventions/**/*.{ts,tsx}"],
      "rules": {
        "no-restricted-imports": [
          "error",
          {
            "patterns": [
              {
                "group": [
                  "@/domains/auth/components/**", "@/domains/auth/hooks/**", "@/domains/auth/services/**", "@/domains/auth/ipc/**",
                  "@/domains/tasks/components/**", "@/domains/tasks/hooks/**", "@/domains/tasks/services/**", "@/domains/tasks/ipc/**",
                  "@/domains/inventory/components/**", "@/domains/inventory/hooks/**", "@/domains/inventory/services/**", "@/domains/inventory/ipc/**"
                ],
                "message": "Domains may only import other domains via their public API (e.g. `@/domains/<domain>`)."
              }
            ]
          }
        ]
      }
    },
    {
      "files": ["src/shared/**/*.{ts,tsx}"],
      "rules": {
        "no-restricted-imports": [
          "error",
          {
            "patterns": [
              {
                "group": ["@/domains/**"],
                "message": "Shared layer must not import from domains."
              }
            ]
          }
        ]
      }
    }
  ]
}
